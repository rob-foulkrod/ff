---
import BaseLayout from '../layouts/BaseLayout.astro';

// Import league data
let leagueData;
try {
  leagueData = await import('../data/league-data.json').then(m => m.default);
} catch (error) {
  leagueData = { seasons: {}, family: { dads: [], sons: [] } };
}

// Sample historical records (would be computed from actual data)
const records = {
  championships: [
    { year: '2023', winner: 'jfoulkrod', record: '11-3', points: 1923.1 },
    { year: '2022', winner: 'devinbattles', record: '10-4', points: 1756.8 },
    { year: '2021', winner: 'DaveKoz', record: '13-1', points: 2043.7 },
    { year: '2020', winner: 'robfoulk', record: '12-2', points: 1834.6 }
  ],
  
  seasonRecords: {
    highestPoints: { player: 'jfoulkrod', year: '2023', points: 1923.1 },
    lowestPoints: { player: 'dakotadknutson', year: '2022', points: 1234.5 },
    bestRecord: { player: 'DaveKoz', year: '2021', wins: 13, losses: 1 },
    worstRecord: { player: 'Eric_K', year: '2020', wins: 2, losses: 12 },
    mostPointsAgainst: { player: 'bbattles2', year: '2023', points: 1834.2 },
    biggestBlowout: { winner: 'robfoulk', loser: 'dakotadknutson', year: '2024', week: 7, margin: 87.4 }
  },
  
  weeklyRecords: {
    highestWeeklyScore: { player: 'jfoulkrod', year: '2023', week: 12, points: 187.3 },
    lowestWeeklyScore: { player: 'Eric_K', year: '2022', week: 3, points: 43.1 },
    mostWeeklyWins: { player: 'robfoulk', count: 47 },
    longestWinStreak: { player: 'DaveKoz', games: 8, season: '2021' },
    longestLoseStreak: { player: 'dakotadknutson', games: 6, season: '2022' }
  },
  
  allTimeStandings: [
    { player: 'robfoulk', championships: 2, wins: 78, losses: 43, winPct: 64.5, totalPoints: 8743.2 },
    { player: 'jfoulkrod', championships: 2, wins: 72, losses: 49, winPct: 59.5, totalPoints: 8934.1 },
    { player: 'DaveKoz', championships: 2, wins: 69, losses: 52, winPct: 57.0, totalPoints: 8456.7 },
    { player: 'devinbattles', championships: 1, wins: 64, losses: 57, winPct: 52.9, totalPoints: 8234.3 },
    { player: 'bbattles2', championships: 1, wins: 58, losses: 63, winPct: 47.9, totalPoints: 8123.5 },
    { player: 'michaelkoz', championships: 0, wins: 54, losses: 67, winPct: 44.6, totalPoints: 7892.1 },
    { player: 'Eric_K', championships: 0, wins: 45, losses: 76, winPct: 37.2, totalPoints: 7654.8 },
    { player: 'dakotadknutson', championships: 0, wins: 41, losses: 80, winPct: 33.9, totalPoints: 7423.9 }
  ],
  
  quirkyRecords: [
    { title: 'Most Times Scoring Exactly 100 Points', player: 'bbattles2', value: '3 times' },
    { title: 'Highest Scoring Loss', player: 'jfoulkrod', value: '156.7 pts (Week 5, 2023)' },
    { title: 'Most Bench Points in a Week', player: 'devinbattles', value: '89.3 pts (Week 8, 2022)' },
    { title: 'Most Times Finishing 2nd', player: 'robfoulk', value: '4 seasons' },
    { title: 'Most Different QBs Started in a Season', player: 'Eric_K', value: '7 QBs (2022)' },
    { title: 'Longest Playoff Drought', player: 'dakotadknutson', value: '3 seasons (2020-2022)' }
  ]
};

// Helper function to get display name
const getDisplayName = (username) => {
  const names = {
    'robfoulk': 'Rob Foulk',
    'jfoulkrod': 'Jake Foulk',
    'bbattles2': 'Brian Battles',
    'devinbattles': 'Devin Battles',
    'DaveKoz': 'Dave Koz',
    'michaelkoz': 'Michael Koz',
    'Eric_K': 'Eric K',
    'dakotadknutson': 'Dakota Knutson'
  };
  return names[username] || username;
};

// Helper function to get trophy emoji
const getTrophyEmoji = (place) => {
  if (place === 1) return '🏆';
  if (place === 2) return '🥈';
  if (place === 3) return '🥉';
  return '🏅';
};
---

<BaseLayout title="Records" description="All-time records and achievements in FoulkNFootball">
  <div class="space-y-8">
    <!-- Page Header -->
    <div class="text-center">
      <h1 class="text-5xl font-bold mb-4">📊 Records</h1>
      <p class="text-xl text-gray-600 dark:text-gray-400">
        The numbers that tell our story
      </p>
    </div>

    <!-- Championship History -->
    <section>
      <h2 class="text-3xl font-bold mb-6 text-yellow-600 dark:text-yellow-400">🏆 Championship History</h2>
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
        {records.championships.map(champ => (
          <div class="bg-gradient-to-br from-yellow-50 to-amber-50 dark:from-yellow-900/20 dark:to-amber-900/20 p-6 rounded-lg border-2 border-yellow-200 dark:border-yellow-800">
            <div class="text-center">
              <h3 class="text-2xl font-bold text-yellow-800 dark:text-yellow-300">{champ.year}</h3>
              <p class="text-xl font-bold mt-2">{getDisplayName(champ.winner)}</p>
              <p class="text-sm text-gray-600 dark:text-gray-400">{champ.record}</p>
              <p class="text-sm text-gray-600 dark:text-gray-400">{champ.points} pts</p>
            </div>
          </div>
        ))}
      </div>
    </section>

    <!-- All-Time Standings -->
    <section>
      <h2 class="text-3xl font-bold mb-6 text-blue-600 dark:text-blue-400">📈 All-Time Standings</h2>
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden">
        <div class="overflow-x-auto">
          <!-- Screen-reader description for the table -->
          <p id="alltime-desc" class="sr-only">All-time standings table showing rank, owner, championships, season record, win percentage, and total points sorted by rank.</p>
          <table class="w-full" aria-describedby="alltime-desc">
            <caption class="sr-only">All-time standings for the FoulkNFootball league.</caption>
            <thead class="bg-gray-50 dark:bg-gray-700">
              <tr>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Rank</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Owner</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Championships</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Record</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Win %</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Total Points</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
              {records.allTimeStandings.map((player, index) => (
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                  <td class="px-4 py-4 whitespace-nowrap">
                    <span class="text-2xl">{getTrophyEmoji(index + 1)}</span>
                    <span class="ml-2 font-bold">{index + 1}</span>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="font-bold">{getDisplayName(player.player)}</div>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <span class="text-2xl">{player.championships > 0 ? '🏆'.repeat(player.championships) : '-'}</span>
                    <span class="ml-2">{player.championships}</span>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap font-mono">
                    <span class="text-green-600">{player.wins}</span>-<span class="text-red-600">{player.losses}</span>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <span class="font-bold">{player.winPct}%</span>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap font-mono">
                    {player.totalPoints.toLocaleString()}
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Season Records -->
    <section>
      <h2 class="text-3xl font-bold mb-6 text-green-600 dark:text-green-400">🎯 Season Records</h2>
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow">
          <h3 class="font-bold text-green-600 mb-2">🔥 Highest Points (Season)</h3>
          <p class="text-2xl font-bold">{records.seasonRecords.highestPoints.points}</p>
          <p class="text-sm text-gray-600 dark:text-gray-400">{getDisplayName(records.seasonRecords.highestPoints.player)} ({records.seasonRecords.highestPoints.year})</p>
        </div>
        
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow">
          <h3 class="font-bold text-blue-600 mb-2">💪 Best Record</h3>
          <p class="text-2xl font-bold">{records.seasonRecords.bestRecord.wins}-{records.seasonRecords.bestRecord.losses}</p>
          <p class="text-sm text-gray-600 dark:text-gray-400">{getDisplayName(records.seasonRecords.bestRecord.player)} ({records.seasonRecords.bestRecord.year})</p>
        </div>
        
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow">
          <h3 class="font-bold text-purple-600 mb-2">💥 Biggest Blowout</h3>
          <p class="text-2xl font-bold">{records.seasonRecords.biggestBlowout.margin} pts</p>
          <p class="text-sm text-gray-600 dark:text-gray-400">{getDisplayName(records.seasonRecords.biggestBlowout.winner)} vs {getDisplayName(records.seasonRecords.biggestBlowout.loser)}</p>
        </div>
        
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow">
          <h3 class="font-bold text-red-600 mb-2">❄️ Lowest Points (Season)</h3>
          <p class="text-2xl font-bold">{records.seasonRecords.lowestPoints.points}</p>
          <p class="text-sm text-gray-600 dark:text-gray-400">{getDisplayName(records.seasonRecords.lowestPoints.player)} ({records.seasonRecords.lowestPoints.year})</p>
        </div>
        
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow">
          <h3 class="font-bold text-orange-600 mb-2">😤 Most Points Against</h3>
          <p class="text-2xl font-bold">{records.seasonRecords.mostPointsAgainst.points}</p>
          <p class="text-sm text-gray-600 dark:text-gray-400">{getDisplayName(records.seasonRecords.mostPointsAgainst.player)} ({records.seasonRecords.mostPointsAgainst.year})</p>
        </div>
        
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow">
          <h3 class="font-bold text-gray-600 mb-2">😞 Worst Record</h3>
          <p class="text-2xl font-bold">{records.seasonRecords.worstRecord.wins}-{records.seasonRecords.worstRecord.losses}</p>
          <p class="text-sm text-gray-600 dark:text-gray-400">{getDisplayName(records.seasonRecords.worstRecord.player)} ({records.seasonRecords.worstRecord.year})</p>
        </div>
      </div>
    </section>

    <!-- Weekly Records -->
    <section>
      <h2 class="text-3xl font-bold mb-6 text-purple-600 dark:text-purple-400">⚡ Weekly Records</h2>
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow">
          <h3 class="font-bold text-green-600 mb-2">🚀 Highest Weekly Score</h3>
          <p class="text-2xl font-bold">{records.weeklyRecords.highestWeeklyScore.points}</p>
          <p class="text-sm text-gray-600 dark:text-gray-400">{getDisplayName(records.weeklyRecords.highestWeeklyScore.player)}</p>
          <p class="text-xs text-gray-500">Week {records.weeklyRecords.highestWeeklyScore.week}, {records.weeklyRecords.highestWeeklyScore.year}</p>
        </div>
        
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow">
          <h3 class="font-bold text-red-600 mb-2">💔 Lowest Weekly Score</h3>
          <p class="text-2xl font-bold">{records.weeklyRecords.lowestWeeklyScore.points}</p>
          <p class="text-sm text-gray-600 dark:text-gray-400">{getDisplayName(records.weeklyRecords.lowestWeeklyScore.player)}</p>
          <p class="text-xs text-gray-500">Week {records.weeklyRecords.lowestWeeklyScore.week}, {records.weeklyRecords.lowestWeeklyScore.year}</p>
        </div>
        
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow">
          <h3 class="font-bold text-blue-600 mb-2">🔥 Longest Win Streak</h3>
          <p class="text-2xl font-bold">{records.weeklyRecords.longestWinStreak.games} games</p>
          <p class="text-sm text-gray-600 dark:text-gray-400">{getDisplayName(records.weeklyRecords.longestWinStreak.player)}</p>
          <p class="text-xs text-gray-500">{records.weeklyRecords.longestWinStreak.season} season</p>
        </div>
        
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow">
          <h3 class="font-bold text-yellow-600 mb-2">⭐ Most Weekly Wins</h3>
          <p class="text-2xl font-bold">{records.weeklyRecords.mostWeeklyWins.count}</p>
          <p class="text-sm text-gray-600 dark:text-gray-400">{getDisplayName(records.weeklyRecords.mostWeeklyWins.player)}</p>
          <p class="text-xs text-gray-500">All-time</p>
        </div>
        
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow">
          <h3 class="font-bold text-gray-600 mb-2">😞 Longest Losing Streak</h3>
          <p class="text-2xl font-bold">{records.weeklyRecords.longestLoseStreak.games} games</p>
          <p class="text-sm text-gray-600 dark:text-gray-400">{getDisplayName(records.weeklyRecords.longestLoseStreak.player)}</p>
          <p class="text-xs text-gray-500">{records.weeklyRecords.longestLoseStreak.season} season</p>
        </div>
      </div>
    </section>

    <!-- Quirky Records -->
    <section class="bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-8 rounded-lg">
      <h2 class="text-3xl font-bold mb-6 text-purple-600 dark:text-purple-400">🤪 Quirky Records</h2>
      <p class="text-gray-600 dark:text-gray-400 mb-6">
        The fun stats that make fantasy football memorable...
      </p>
      
      <div class="grid md:grid-cols-2 gap-6">
        {records.quirkyRecords.map(record => (
          <div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">
            <h3 class="font-bold text-purple-600 mb-2">{record.title}</h3>
            <p class="text-lg font-bold">{getDisplayName(record.player)}</p>
            <p class="text-sm text-gray-600 dark:text-gray-400">{record.value}</p>
          </div>
        ))}
      </div>
    </section>

    <!-- Record Submission -->
    <section class="bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg text-center">
      <h2 class="text-2xl font-bold mb-4 text-blue-800 dark:text-blue-300">📝 Think We Missed Something?</h2>
      <p class="text-gray-600 dark:text-gray-400 mb-4">
        Know of a record that should be tracked? Let us know!
      </p>
      <button type="button" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors">
        Suggest a Record
      </button>
    </section>
  </div>
</BaseLayout>

<style>
  .record-card {
    transition: transform 0.2s ease;
  }
  
  .record-card:hover {
    transform: translateY(-2px);
  }
</style>
